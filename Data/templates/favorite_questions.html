{% extends 'base.html' %}
{% load static %}

{% block title %}Favorite Questions - DataScope{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/upload.css' %}">
<style>
  .favorite-container {
      max-width: 1200px;
      margin: 6rem auto 2rem;
      padding: 3rem;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  }
  .favorite-container h1 {
      font-size: 2rem;
      font-weight: 800;
      color: #2D1B69;
      margin-bottom: 1.5rem;
      text-align: center;
  }
  .favorite-box {
      border: 2px dashed #8B45C7;
      border-radius: 15px;
      padding: 2rem;
      background: rgba(139, 69, 199, 0.05);
      margin-bottom: 2rem;
  }
  .favorite-box h3 {
      font-size: 1.5rem;
      font-weight: 700;
      color: #2D1B69;
      margin-bottom: 1rem;
  }
  .favorite-box, .favorite-box * { color: #2D1B69; }
  .submit-btn {
      padding: 0.8rem 2rem;
      background: linear-gradient(135deg, #8B45C7, #A855C7);
      color: white;
      border: none;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(139, 69, 199, 0.3);
  }
  .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(139, 69, 199, 0.4); }

  .btn-primary {
      padding: 0.8rem 2rem;
      background: linear-gradient(135deg, #8B45C7, #A855C7);
      color: white;
      border: none;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(139, 69, 199, 0.3);
  }

  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(139, 69, 199, 0.4); }

  .btn-danger {
      padding: 0.8rem 2rem;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
  }

  .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4); }

  .stylish-textarea {
      border-radius: 15px;
      border: 1px solid #ced4da;
      padding: 10px;
      transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
      width: 100%;
  }

  .stylish-textarea:focus {
      border-color: #8B45C7;
      outline: 0;
      box-shadow: 0 0 0 0.25rem rgba(139, 69, 199, 0.25);
  }
</style>
{% endblock %}

{% block content %}
<section class="favorite-container">
    <h1>Favorite Questions</h1>
    <p style="margin-bottom: 2rem; color: #666; text-align:center;">
      Manage your saved questions to quickly reuse them in the chat.
    </p>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}

    <div class="favorite-box">
        <h3>Save a New Favorite Question</h3>
        <form action="{% url 'favorite_questions' %}" method="post">
            {% csrf_token %}
            <div class="mb-3">
                <label for="{{ form.question_text.id_for_label }}" class="form-label">{{ form.question_text.label }}</label>
                {{ form.question_text }}
            </div>
            <button type="submit" class="submit-btn">Save</button>
        </form>
    </div>

    <div class="favorite-box">
        <h3>Your Saved Questions</h3>
        {% if favorites %}
            <ul class="list-group list-group-flush">
                {% for fav in favorites %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <p class="mb-0">{{ fav.question_text }}</p>
                        <div class="d-flex ms-auto">
                            <a href="{% url 'use_favorite_question' fav.id %}" class="btn btn-sm btn-primary">Use</a>
                            <form action="{% url 'delete_favorite_question' fav.id %}" method="post" class="d-inline ms-2" onsubmit="return confirm('Are you sure you want to delete this question?');">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                            </form>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>You have no saved questions yet.</p>
        {% endif %}
    </div>
</section>
{% endblock %}
